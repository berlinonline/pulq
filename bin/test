#!/bin/sh

PROJECT=`readlink -f $( dirname $0 )/..`
LOCAL_CONFIG_SH=$PROJECT/etc/local/local.config.sh

if [ -f $LOCAL_CONFIG_SH ] ; then
  echo "[INFO] Found and sourcing the local.config.sh"
  . $LOCAL_CONFIG_SH
else
  echo "[ERROR] Could not source $LOCAL_CONFIG_SH!"
  echo "Make sure to run bin/configure-env before doing anything else after a fresh checkout"
fi

if (test -z "$PHP_COMMAND") ; then
  echo "[ERROR] Unable to find a valid php command!"
  echo "Have you run bin/configure-env.php allready?"
  exit 0
fi

cmd="$PHP_COMMAND -d html_errors=off -f $PROJECT/testing/run-tests.php -- $@"
echo [Executing] $cmd
PHP_COMMAND=$PHP_COMMAND $(which rlwrap) $cmd
